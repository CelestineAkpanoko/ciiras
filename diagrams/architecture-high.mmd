flowchart LR
  subgraph GH[GitHub]
    GA[GitHub Actions Workflow Run]
    JOBS[Job List + Annotations]
  end

  subgraph CIIRAS[CIIRAS Core]
    DET[Detection Pipeline]
    INC[(Incident Record)]
    AUD[(Audit Log)]
    POL[Policy Engine]
    SM[State Machine]
  end

  GA --> DET
  JOBS --> DET

  DET --> INC
  DET --> AUD

  INC --> SM
  SM --> AUD

  INC --> POL
  POL --> AUD

  %% Later phases (not implemented in Phase 1)
  INC -.-> ANALYSIS[Analysis Engine]
  INC -.-> STRAT[Strategy Plugins]
  INC -.-> VALID[Validation Sandbox]
  INC -.-> PR[PR Creator]

  %% MCP tool boundary (conceptual)
  DET -.-> MCP[MCP Tools: GitHub + FS + Diagnostics]
  ANALYSIS -.-> MCP
  STRAT -.-> MCP
  VALID -.-> MCP
  PR -.-> MCP
